# Задача
В эпоху постоянных изменений, когда цены на недвижимость растут быстрее, чем заработные платы, люди стремятся найти наиболее рациональный способ извлечь максимальную выгоду, затратив минимум средств. Понимание факторов, влияющих на ценообразование, имеет чрезвычайно важное значение для получения конкурентных преимуществ и выгоды, и сфера недвижимости не является исключением.

К вам обратился заказчик, желающий построить систему ценообразования объектов недвижимости, и для начала он хотел бы получить модель для предсказания стоимости жилья на основе объявлений о продаже.

## Постановка задачи в терминах ML

**Задача:** Построить регрессионную модель для предсказания стоимости жилья на основе данных об объявлениях о продаже квартир в Москве и Московской области.

**Входные данные:** Датасет с характеристиками квартир.

**Выходные данные:** Предсказанная стоимость квартиры.

## Определение и обоснование ML-метрик

### Метрики
1. **MAE (Mean Absolute Error):**
   - Обоснование: MAE измеряет среднюю абсолютную ошибку модели. Легко интерпретируемая метрика, которая показывает, насколько в среднем наши предсказания отличаются от фактических значений.
   
2. **RMSE (Root Mean Squared Error):**
   - Обоснование: RMSE более чувствителен к большим ошибкам. Хорошо подходит для данной задачи, так как большие ошибки в предсказании стоимости жилья могут быть критичны.
   
3. **R² (Coefficient of Determination):**
   - Обоснование: R² показывает, какая доля дисперсии зависимой переменной объясняется моделью. Это поможет оценить качество модели в целом.

## Подготовка данных

### Обработка пропусков
1. **product_name, address_name, description, source:** Пропуски можно игнорировать, так как они не влияют на модель.
2. **postcode, city, settlement, district, area:** Пропуски можно заполнить значением "Unknown" или средним значением в случае числовых данных.
3. **lat, lon:** Можно заполнить средними значениями координат для данного района.
4. **object_type, rooms, floor:** Пропуски можно заполнить на основе наиболее часто встречающихся значений в датасете.
5. **total_square:** Можно использовать медианное значение для данного района.

### Кодирование категориальных переменных
1. **postcode, city, settlement, district, area, object_type, source:** 
   - Используем One-Hot Encoding, так как это даст возможность модели учитывать все категории отдельно, что важно для категориальных данных.
   
### Создание новых признаков
1. **Этажность здания:** Можно создать новый признак, показывающий отношение этажа квартиры к общему числу этажей в здании (если есть такие данные).
2. **Плотность населения района:** На основе postcode можно добавить данные о плотности населения.
3. **Близость к центру:** На основе lat и lon можно вычислить расстояние до центра города.

## Разделение выборки

**Разделение на обучающую и тестовую выборки:**
   - 80% данных на обучение, 20% на тестирование.
   - Используем разделение по району, чтобы обеспечить равномерное распределение

## Структура бейзлайна и процесса валидации
1. Бейзлайн-модель:
    - Простая линейная регрессия.
    - Дерево решений.
    - Среднее значение стоимости как предсказание для всех объектов.
2. Процесс валидации:
    - Кросс-валидация с K = 5. Это позволит уменьшить вероятность переобучения и оценить стабильность модели.
    - При кросс-валидации будем использовать стратифицированные разбиения по району.

## Более сложные модели и их обоснование
1. Random Forest Regressor. Хорошо справляется с нелинейными зависимостями и автоматически учитывает важность признаков.

2. Gradient Boosting (например, XGBoost, LightGBM). Эти модели обычно показывают высокую точность на задачах регрессии благодаря их способности корректировать ошибки предыдущих деревьев.

3. Neural Networks (например, MLPRegressor). Могут улавливать сложные нелинейные зависимости, особенно при большом количестве данных.
4. CatBoost. Хорошо работает с категориальными данными и может автоматизировать процесс обработки категориальных переменных.

# Вывод
Этот концептуальный план работы над ML-решением для предсказания стоимости жилья включает все необходимые шаги для создания и оценки модели. Включает формулировку задачи, определение метрик, подготовку данных, процесс разделения выборки, создание бейзлайна и выбор более сложных моделей. Этот подход обеспечит построение качественной модели, которая поможет заказчику предсказывать стоимость жилья с высокой точностью.
